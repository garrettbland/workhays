<% /* ===========================================================================
Description: Account information page. To Do: archive view, edit view, new listing view Params:
=========================================================================== */ %>
<!DOCTYPE html>
<html class="h-full" lang="en">

<body class="flex w-full flex-col h-full">
<nav>
	<%- include('../partials/navbar', { title: 'Work Hays' }) %>
</nav>

<main class="flex-1 mx-auto pt-32 container max-w-6xl p-12 bg-gray-200 shadow-xl">
	<a href="/" class="flex w-1/4 mb-4 flex-row items-center text-blue-500 hover:text-blue-400 text-base">
		<div><span class="mdi mdi-arrow-left"/></div>
		<div class="ml-2">Back to All Listings</div>
	</a>
	<div class="text-xl font-bold pb-6">Welcome,&nbsp;<%= (user.first_name) %></div>
	<div class="flex flex-col">
		<% if(message.length > 0) { %>
			<div class="bg-green-500 text-green-100 p-4 mb-2 rounded shadow">
				<%= message %>
			</div>
		<% } %>
		<div class="p-6 bg-white shadow-xl w-4/5 mx-auto rounded mb-4">
			<div class="text-gray-500 font-bold">Active Job Listings</div>
			<div class="px-8 mt-3">
				<% jobs.forEach(function(job) { %>
					<div class="mt-1 mb-1 p-2 pl-4 pr-4 bg-white border-green-400 border mx-auto max-w-5xl rounded">
						<div class="flex justify-between">
							<div class="flex flex-col">
								<div class="text-xl"><%= job.title %></div>
								<div class="flex flex-row italic text-gray-600 text-sm">
									<div><%= job.updatedAt %></div>
								</div>
							</div>
							<div class="flex items-center">
								<a href="/jobs/<%= job.id %>" target="_blank"
									 class="px-2 mr-2 py-2 bg-transparent text-blue-500 cursor-pointer hover:bg-blue-400 rounded text-sm focus:outline-none border border-blue-500 hover:border-transparent hover:text-white">View
									Listing</a>
								<a href="/jobs/edit/<%= job.id %>"
									 class="px-2 py-2 bg-transparent text-blue-500 cursor-pointer hover:bg-blue-400 focus:bg-blue-400 rounded text-sm focus:outline-none border border-blue-500 hover:border-transparent hover:text-white">Edit
									Listing</a></div>
						</div>
					</div>
				<% }) %>
			</div>
			<div class="px-8 mt-3">

				<div class="flex justify-end mt-4">
					<a href="/job-listing-archive"
						 class="bg-red-500 hover:bg-red-400 mr-4 px-4 py-2 rounded text-white focus:outline-none">
						View Archived Listings
					</a>
					<a href="/job-listing-new"
						 class="bg-blue-500 hover:bg-blue-400 px-4 py-2 rounded text-white focus:outline-none">
						New Job Listing
					</a>
				</div>
			</div>
		</div>
		<div class="p-6 bg-white shadow-xl w-4/5 mx-auto rounded mb-4">
			<div class="text-gray-500 font-bold">Business Settings</div>
			<form onsubmit="saveDataAndSubmit();" method="POST" action="/employers/edit/<%= employer.id %>" class="bg-white px-8 pt-6">
				<div>
					<div class="flex flex-wrap -mx-3 mb-6">
						<div class="w-1/2 px-3">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-business-name">
								Business Name
							</label>
							<input name="title" value="<%= employer.title %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-business-name" type="text" placeholder="Acme Corp."/>
						</div>
						<div class="w-1/2 px-3">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-business-name">
								Contact Name
							</label>
							<input name="contact" value="<%= employer.contact %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-business-name" type="text" placeholder="Jane Doe"/>
						</div>
					</div>
					<div class="flex flex-wrap -mx-3 mb-6">
						<div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-email">
								Contact Email
							</label>
							<input name="email" value="<%= employer.email %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"
										 id="grid-email" type="text" placeholder="janedoe@example.com"/>
						</div>
						<div class="w-full md:w-1/2 px-3">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-phone">
								Contact Phone Number
							</label>
							<input name="phone" value="<%= employer.phone %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-phone" type="text" placeholder="785-867-5309"/>
						</div>
					</div>
					<div class="flex flex-wrap -mx-3 mb-6">
						<div class="w-full px-3">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-business-about">
								About Business
							</label>
							<div class="shadow rounded p-4">
								<div id="businessdescription"></div>
							</div>
							<input hidden id="description_input" name="description"/>
							<!-- <textarea name="description"
												class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
												id="grid-business-about" rows="3"
												placeholder="Please tell us a little about your business."><%= employer.description %></textarea> -->
						</div>
					</div>
					<div class="flex flex-wrap -mx-3 mb-2">
						<div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-city">
								Logo URL
							</label>
							<input name="logo_url" value="<%= employer.logo_url %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-city" type="text" placeholder="Logo URL"/>
						</div>
						<div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-zip">
								Website URL
							</label>
							<input name="website_url" value="<%= employer.website_url %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-zip" type="text" placeholder="www.example.com"/>
						</div>
					</div>
					<div class="flex flex-wrap -mx-3 mb-2">
						<div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-city">
								Facebook Page URL
							</label>
							<input name="facebook_url" value="<%= employer.facebook_url %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-city" type="text" placeholder="www.facebook.com/username"/>
						</div>
						<div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
							<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
										 for="grid-zip">
								Twitter Page URL
							</label>
							<input name="twitter_url" value="<%= employer.twitter_url %>"
										 class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
										 id="grid-zip" type="text" placeholder="www.twitter.com/username"/>
						</div>
					</div>
					<div class="flex justify-end mt-4">
						<button
							id=""
							class="bg-green-500 hover:bg-green-400 px-4 py-2 rounded text-white focus:outline-none">
							Save Business Changes
						</button>
					</div>
				</div>
			</form>
		</div>
	</div>
	<div class="p-6 bg-white shadow-xl w-4/5 mx-auto rounded mb-4">
		<div class="text-gray-500 font-bold">Account Settings</div>
		<div class="bg-white px-8 pt-6">
			<div class="flex flex-wrap -mx-3 mb-2">
				<div class="flex flex-col w-full md:w-1/2 px-3 mb-6 md:mb-0">
					<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
								 for="grid-zip">Password Reset
					</label>
					<a href="/password-reset">
						<div
							class="border-2 text-center hover:border-blue-400 border-blue-500 bg-blue-500 hover:bg-blue-400 px-4 py-2 rounded text-white focus:outline-none">
							Click Here to Reset Password
						</div>
					</a>
				</div>
				<form method="POST" action="/account/change_email" class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
					<label class="block uppercase tracking-wide text-gray-800 text-xs font-bold mb-2"
								 for="grid-zip">
						Update Email Address
					</label>
					<input
						name="user_email"
						class="appearance-none block w-full bg-gray-200 text-gray-800 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-blue-400"
						id="grid-zip" type="text" placeholder="<%= user.email %>"/>
					<div class="flex justify-end mt-4">
						<button class="bg-green-500 hover:bg-green-400 px-4 py-2 rounded text-white focus:outline-none">
							Update Email Address
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</main>


<script>
	const editor = new EditorJS({ 
	  /** 
	   * Id of Element that should contain the Editor 
	   */ 
	  holder: 'businessdescription', 
	  placeholder: 'Describe your business',
	  data: <%- employer.description %>,
	  tools: {
		header: Header,
		list: List
	},
	})


	function saveDataAndSubmit() {

		var description = document.getElementById('description_input')

		editor.save().then((outputData) => {
			console.log('Article data: ', outputData)
			description.value = JSON.stringify(outputData)
			return true
		}).catch((error) => {
			console.log('Saving failed: ', error)
			window.alert('Error, save failed')
		});
	}



</script>

	
<footer class="text-center bg-gray-200 container pb-8 max-w-6xl shadow-xl mx-auto pin-b">
	<%- include('../partials/footer') %>
</footer>
</body>

</html>